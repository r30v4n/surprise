<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, viewport-fit=cover"
/>
<title>Birthday Surprise üéâ</title>
<style>
  /* ===== Base / Mobile-first (Nothing Phone 3a friendly) ===== */
  * { box-sizing: border-box; }
  html, body { height: 100%; }
  html, body {
    margin: 0;
    padding: 0;
    overflow-x: hidden; /* no sideways scroll */
    -webkit-tap-highlight-color: transparent;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans";
    color: #fff;
    background: linear-gradient(135deg, #00c6ff, #0072ff); /* keep your gradient */
    position: relative;
    text-align: center;
  }

  /* ===== Layout ===== */
  .wrap {
    padding: 16px clamp(12px, 4vw, 28px);
    max-width: 980px;
    margin: 0 auto;
  }

  /* ===== Heading ===== */
  h1{
    text-align:center;
    margin: 1.1rem auto 0.5rem;
    font-weight: 800;
    line-height: 1.15;
    letter-spacing: 0.6px;
    font-size: clamp(1.9rem, 6.5vw, 3.2rem);
    background: linear-gradient(135deg, #ff512f, #dd2476);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 0 18px rgba(255,180,210,.65);
  }

  /* ===== Buttons ===== */
  .btn-row{
    display:flex;
    gap: 10px;
    justify-content:center;
    align-items:center;
    flex-wrap: wrap;
    margin: 0.5rem 0 1rem;
  }
  .btn{
    padding: 0.9rem 1.6rem;
    font-size: clamp(1rem, 4.2vw, 1.2rem);
    font-weight: 800;
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    color: #fff;
    border:none;
    border-radius: 999px;
    box-shadow: 0 10px 24px rgba(0,0,0,.18);
    cursor:pointer;
    transition: transform .2s ease, background .35s ease;
  }
  .btn:hover,
  .btn:focus-visible,
  .btn:active{
    background: linear-gradient(135deg, #11998e, #38ef7d); /* gradient on hover/tap */
    transform: translateY(-1px) scale(1.02);
  }
  .btn.secondary{
    background:#ffffffc9;
  }

  #replayBtn{
    display: none;
    background: linear-gradient(135deg, #8e2de2, #4a00e0);
    color: #fff;
    padding: 12px 28px;
    font-size: 1.1rem;
    font-weight: 600;
    border: none;
    border-radius: 30px;
    cursor: pointer;
    transition: background 0.4s ease;
}

#replayBtn:hover {
  background: linear-gradient(135deg, #ff0080, #ff8c00);
}
  /* ===== Buffalo emoji ===== */
  #animatedEmoji{
    position: fixed; /* viewport-based */
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%); /* base; we animate left/top for smooth motion */
    z-index: 1000;
    display: none;     /* pops in when main starts */
    opacity: 1;        /* no fade-in on start */
    font-size: clamp(4.5rem, 22vw, 9rem);
    line-height: 1;
    user-select: none;

    /* smooth motion + transform + fade-out */
    transition:
      left 1.9s ease-in-out,
      top 1.9s ease-in-out,
      transform .55s ease,
      opacity .65s ease;
  }
  #animatedEmoji.fade-out{ opacity: 0; }

  /* ===== Slideshow images (on top of everything) ===== */
  .slideshow-img{
    position: fixed;
    opacity: 0;
    transition: opacity 0.6s ease;
    z-index: 9999;
    pointer-events: none;
    will-change: opacity, transform, left, top, width, height;
  }

  /* ===== Morphing text area ===== */
  .morph-wrap{
    position: relative;
    min-height: 60vh;
    display: grid;
    place-items: center;
    margin: 12vh 0 10vh;
  }
  .morph-stack{
    display: grid;
    gap: clamp(10px, 2.6vh, 16px);
    place-items: center;
    width: 100%;
    max-width: min(720px, 92vw);
  }
  .morph-text{
    font-weight: 800;
    letter-spacing: .4px;
    font-size: clamp(1.2rem, 6vw, 2rem);
    line-height: 1.18;
    padding: .35rem .6rem;
    border-radius: 12px;
    background: linear-gradient(135deg, #f7971e, #ffd200);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 0 12px rgba(255,255,255,.35);
    opacity: 0;
    transform: translateY(44px);
    transition: transform 0.9s ease-out, opacity 0.9s ease-out;
    will-change: transform, opacity;
  }
  .morph-text.show{
    opacity: 1;
    transform: translateY(0);
  }

  /* ===== A11y reduced motion ===== */
  @media (prefers-reduced-motion: reduce){
    #animatedEmoji, .slideshow-img, .morph-text{ transition:none !important; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <h1>HAPPY BIRTHDAY GURL!!!</h1>

    <div class="btn-row">
      <button id="musicBtn" class="btn" aria-label="Play main song">CLICK KAR!</button>
      <button id="replayBtn" class="btn secondary" aria-label="Replay slideshow and texts">Replay</button>
    </div>

    <!-- Hidden animated buffalo emoji, appears only during main song -->
    <div id="animatedEmoji" aria-hidden="true">üêÉ</div>

    <!-- Morph texts (hardcoded 3) -->
    <div class="morph-wrap">
      <div id="morphStack" class="morph-stack">
        <div class="morph-text" id="morph1">Never thought i would find such an incredible friend as you</div>
        <div class="morph-text" id="morph2">With every friend of mine, i think,</div>
        <div class="morph-text" id="morph3">I have a feeling of competition</div>
        <div class="morph-text" id="morph4">feeling of comparison,</div>
        <div class="morph-text" id="morph5">koi merse accha, koi merse bekaar,</div>
        <div class="morph-text" id="morph6">except you ‚ú®</div> 
        <div class="morph-text" id="morph7">I want to be helped by you</div> 
        <div class="morph-text" id="morph8">I want to help you</div> 
        <div class="morph-text" id="morph9">You are awesome!</div> 
        <div class="morph-text" id="morph10">You are incredible!</div> 
        <div class="morph-text" id="morph11">Days with you are always magical</div> 
        <div class="morph-text" id="morph12">best üêÉ ever!</div> 
      </div>  
    </div>
  </div>

  <!-- AUDIO: set your sources below -->
  <audio id="mainSong"></audio>           <!-- TODO: set MAIN_SONG_URL below -->
  <audio id="backgroundMusic" loop></audio> <!-- TODO: set BG_MUSIC_URL below -->

<script>
/* =========================================================
   CONFIG: set your audio + slideshow images here
   ========================================================= */
const MAIN_SONG_URL = "Birthday song XD.mp3";              // <-- replace
const BG_MUSIC_URL  = "SpotiDown.App - Past Lives - Piano Version - sapientdream.mp3";       // <-- replace

/* Put ANY number of images here. They will show ONCE each (no loop).
   Example filenames: "photo1.jpg", "bff.png", "cake.jpeg"
   Replace these placeholders with your own paths. */
const SLIDESHOW_IMAGES = [
  "img1.jpg",
  "img2.jpg",
  "img3.jpg",
  "img4.jpg",
  "img5.jpg",
  "img6.jpg",
  "img7.jpg",
  "img8.jpg",
  "img9.jpg",
  "img10.jpg",
  "img11.jpg"
];

/* =========================================================
   ELEMENTS
   ========================================================= */
const btn       = document.getElementById('musicBtn');
const replayBtn = document.getElementById('replayBtn');
const mainSong  = document.getElementById('mainSong');
const bgMusic   = document.getElementById('backgroundMusic');
const buffalo   = document.getElementById('animatedEmoji');
const morphEls  = [document.getElementById('morph1'), 
document.getElementById('morph2'), 
document.getElementById('morph3'),
document.getElementById('morph4'),
document.getElementById('morph5'),
document.getElementById('morph6'),
document.getElementById('morph7'),
document.getElementById('morph8'),
document.getElementById('morph9'),
document.getElementById('morph10'),
document.getElementById('morph11'),
document.getElementById('morph12'),
];

/* =========================================================
   AUDIO SETUP
   ========================================================= */
mainSong.src = MAIN_SONG_URL;
bgMusic.src  = BG_MUSIC_URL;
bgMusic.volume = 0.20; // subtle
let isMainPlaying = false;
let bgHasStartedOnce = false;
let slideshowStarted = false;

/* =========================================================
   BUFFALO MOTION STATE
   ========================================================= */
let moveInterval = null;
let animTimeout  = null;

/* =========================================================
   BUTTON: play main song
   ========================================================= */
btn.addEventListener('click', async () => {
  // Stop BG while main plays (as per earlier behavior)
  if (!bgMusic.paused) {
    bgMusic.pause();
    bgMusic.currentTime = 0;
  }

  if (!isMainPlaying) {
    await startMainSong();
  }
});

/* =========================================================
   MAIN SONG FLOW
   ========================================================= */
async function startMainSong(){
  isMainPlaying = true;
  mainSong.currentTime = 0;

  // Show buffalo instantly (no fade-in), at a random start spot
  showBuffaloAtRandomPosition();

  // Start smooth motion + random animations
  startBuffaloMotion();

  try { await mainSong.play(); } catch(e){ console.warn('Main song play blocked:', e); }
}

mainSong.addEventListener('ended', () => {
  isMainPlaying = false;

  // stop buffalo & fade it out
  stopBuffaloMotion(true);

  // First time main finishes ‚Üí start BG + slideshow
  if (!bgHasStartedOnce) {
    bgHasStartedOnce = true;
    bgMusic.currentTime = 0;
    bgMusic.play().catch(()=>{});
  } else {
    // Subsequent finishes ‚Üí just resume BG
    bgMusic.play().catch(()=>{});
  }
});

// Start slideshow only the first time background music actually starts playing
bgMusic.addEventListener('play', () => {
  if (bgHasStartedOnce && !slideshowStarted) {
    slideshowStarted = true;
    startSlideshowOnce();
  }
});

/* =========================================================
   BUFFALO BEHAVIOUR
   ========================================================= */
function showBuffaloAtRandomPosition(){
  buffalo.classList.remove('fade-out');
  buffalo.style.display = 'block';  // pops in
  buffalo.style.opacity = '1';
  placeBuffaloRandomly();           // initial position
}

function startBuffaloMotion(){
  clearInterval(moveInterval);
  clearTimeout(animTimeout);

  // First movement shortly after showing
  animTimeout = setTimeout(() => {
    moveBuffaloToRandom();
    doRandomAnimation();
  }, 350);

  // Keep moving every ~2.2s with animation
  moveInterval = setInterval(() => {
    if (!isMainPlaying) { clearInterval(moveInterval); return; }
    moveBuffaloToRandom();
    doRandomAnimation();
  }, 2200);
}

function stopBuffaloMotion(fadeOut){
  clearInterval(moveInterval);
  clearTimeout(animTimeout);

  if (fadeOut){
    buffalo.classList.add('fade-out');
    setTimeout(() => {
      buffalo.style.display = 'none';
      buffalo.style.transform = 'translate(-50%,-50%)'; // reset transform (rotation/scale)
      buffalo.classList.remove('fade-out');
    }, 700);
  }
}

// Compute safe random coordinates so buffalo stays fully on-screen
function placeBuffaloRandomly(){
  const rect = buffalo.getBoundingClientRect();
  const w = rect.width  || (window.innerWidth * 0.3);
  const h = rect.height || (window.innerWidth * 0.3);

  const maxX = Math.max(0, window.innerWidth  - w);
  const maxY = Math.max(0, window.innerHeight - h);

  const x = Math.random() * maxX;
  const y = Math.random() * maxY;

  buffalo.style.left = x + 'px';
  buffalo.style.top  = y + 'px';
}

// Smooth move (CSS animates left/top)
function moveBuffaloToRandom(){
  placeBuffaloRandomly();
}

// Random animation from {spin, flip, rotate, pulse}
function doRandomAnimation(){
  const which = Math.floor(Math.random() * 4);
  switch(which){
    case 0: spinAnim();   break;
    case 1: flipAnim();   break;
    case 2: rotateAnim(); break;
    case 3: pulseAnim();  break;
  }
}

function spinAnim(){
  buffalo.style.transform = 'translate(-50%,-50%) rotate(720deg)';
  setTimeout(()=>{ buffalo.style.transform = 'translate(-50%,-50%) rotate(0)'; }, 600);
}
function flipAnim(){
  buffalo.style.transform = 'translate(-50%,-50%) scaleX(-1) scale(1.15)';
  setTimeout(()=>{ buffalo.style.transform = 'translate(-50%,-50%) scaleX(1) scale(1)'; }, 450);
}
function rotateAnim(){
  buffalo.style.transform = 'translate(-50%,-50%) rotate(360deg)';
  setTimeout(()=>{ buffalo.style.transform = 'translate(-50%,-50%) rotate(0)'; }, 900);
}
function pulseAnim(){
  buffalo.style.transform = 'translate(-50%,-50%) scale(1.25)';
  setTimeout(()=>{ buffalo.style.transform = 'translate(-50%,-50%) scale(1)'; }, 500);
}

// Keep buffalo in bounds if viewport resizes mid-song
window.addEventListener('resize', () => {
  if (buffalo.style.display !== 'none') placeBuffaloRandomly();
});
          
/* =========================================================
   SLIDESHOW ‚Äî RUNS ONCE ONLY
   - Each image fades in ‚Üí stays 3s ‚Üí fades out
   - Random position, no overflow
   - Size: proportional, random scale in [0.6, 1.0] of original
     If image is huge, we cap to fit viewport.
   After slideshow ends ‚Üí trigger morph texts sequence.
   ========================================================= */
let slideshowRunning = false;
let slideshowCancel = null; // function to cancel timeouts if needed

function startSlideshowOnce(){
  if (!SLIDESHOW_IMAGES.length || slideshowRunning) return;
  document.getElementById("replayBtn").style.display = "none";

  slideshowRunning = true;  

  // Create a shuffled order (once)
  const order = SLIDESHOW_IMAGES.slice();
  for (let i = order.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [order[i], order[j]] = [order[j], order[i]];
  }

  const timers = new Set();
  slideshowCancel = () => { timers.forEach(id => clearTimeout(id)); };

  let idx = 0;

  function showNext(){
    if (idx >= order.length) {
      // Done ‚Äî start morph texts
      slideshowRunning = false;
      startMorphTextsSequence();
      return;
    }

    const src = order[idx++];
    const img = document.createElement('img');
    img.src = src;
    img.className = 'slideshow-img';
    img.style.maxWidth = 'none';
    img.style.maxHeight = 'none';
    document.body.appendChild(img);

    img.onload = () => {
      const vw = window.innerWidth;
      const vh = window.innerHeight;

      const naturalW = img.naturalWidth || 800;
      const naturalH = img.naturalHeight || 600;
      const aspect   = naturalW / naturalH;

      // Base random scale in [0.6, 1.0]
      let scale = 0.6 + Math.random() * 0.4;

      let dispW = naturalW * scale;
      let dispH = naturalH * scale;

      // Ensure it fits viewport (cap down if necessary)
      const padW = Math.max(12, vw * 0.04);   // margin to avoid touching edges
      const padH = Math.max(16, vh * 0.07);
      const fitScale = Math.min((vw - padW) / dispW, (vh - padH) / dispH, 1);
      if (fitScale < 1) {
        // Cap to fit; (rare) may dip below 60% if original is huge
        dispW *= fitScale;
        dispH *= fitScale;
      }

      img.style.width  = dispW + 'px';
      img.style.height = dispH + 'px';

      // Random position that keeps image fully in view
      const maxX = Math.max(0, vw - dispW);
      const maxY = Math.max(0, vh - dispH);
      const left = Math.random() * maxX;
      const top  = Math.random() * maxY;

      img.style.left = left + 'px';
      img.style.top  = top  + 'px';

      // Fade in ‚Üí stay 3s ‚Üí fade out ‚Üí next
      // Fade-in 0.6s, Hold 3.0s, Fade-out 0.6s
      requestAnimationFrame(() => { img.style.opacity = '1'; });

      const t1 = setTimeout(() => { img.style.opacity = '0'; }, 3600);
      const t2 = setTimeout(() => {
        img.remove();
        showNext();
      }, 4200);

      timers.add(t1); timers.add(t2);
    };

    img.onerror = () => {
      // Skip broken image and continue
      img.remove();
      showNext();
    };
  }

  showNext();
}

/* =========================================================
   MORPH TEXTS ‚Äî AFTER SLIDESHOW ENDS
   All from below ‚Üí to their spots, one after another, then stay.
   ========================================================= */
function resetMorphTexts(){
  morphEls.forEach(el => el.classList.remove('show'));
}
function startMorphTextsSequence(){
  resetMorphTexts();
  // Appear one by one; same timing for each
  morphEls.forEach((el, i) => {
    setTimeout(() => {
      el.classList.add('show');
      if (i === morphEls.length - 1) {
        setTimeout(() => {
          document.getElementById("replayBtn").style.display = "block";
        }, 1000); // add small delay so it's smooth
      }
    }, i * 1500);
  });
}

/* =========================================================
   REPLAY: restart slideshow + text sequence (does not touch music/buffalo)
   ========================================================= */
replayBtn.addEventListener('click', () => {
  // Cancel any pending slideshow timeouts and remove active images
  if (typeof slideshowCancel === 'function') slideshowCancel();
  document.querySelectorAll('.slideshow-img').forEach(el => el.remove());
  slideshowRunning = false;

  // Reset morph texts
  resetMorphTexts();

  // Only allow replay if BG has started at least once (as per your rule)
  if (bgHasStartedOnce) {
    // Restart slideshow; morphs will auto-start after it ends
    startSlideshowOnce();
  }
});
</script>
</body>

</html>



